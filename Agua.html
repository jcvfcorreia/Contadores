<html>
    <head>
        <script>
            $(document).ready(function(){
                $.fn.table=function(){
                    $.ajax({
                            method: "GET",
                            url: "http://192.168.1.8:3000/agua"
                        })
                        .done(function( msg ) {                                                        
                            $('#example').DataTable( {
                                data: msg,
                                columns: [
                                    { data: 'data' },
                                    { data: 'valor' },
                                    { data: 'consumo' }                                    
                                ]
                            } );                                                                                               
                        });
                }
                $("#validation")[0].innerHTML = '';
                $("#submitAgua").click(function(){
                    if($("#dataContagem").val() === '' || $("#Contagem").val() === ''){                        
                        $("#validation")[0].innerHTML = '<div>Erro ao gravar dados!!</div>';
                    }else{
                        $.ajax({
                            method: "POST",
                            url: "http://192.168.1.8:3000/agua",                                                      
                            data: {"data":$("#dataContagem").val().replaceAll('-',''),"valor":$("#dataContagem").val()},
                            dataType: 'json'
                        })
                        .done(function( msg ) {
                            $.fn.table();
                        });                                                
                    }
                });
            });
        </script>
    </head>
    <body>        
        <table>
            <tr>
               <td colspan="2" style="text-align: center;">
                    √Ågua
               </td> 
            </tr>
            <tr>
                <td>
                    <label for="dataContagem" class="form-label">Dia</label>
                    <input type="date" name="dataContagem" id="dataContagem" required class="form-control"/>
                </td>
            </tr>
            <tr>
                <td>
                    <label for="Contagem" class="form-label">Contagem</label>
                    <input type="number" name="Contagem" id="Contagem" required class="form-control"/>
                </td>
            </tr>
            <tr>
                <td colspan="2" id="validation"></td>
            </tr>            
            <tr>
                <td colspan="2">
                    <button type="button" id="submitAgua" class="btn btn-success">Gravar</button>
                    <button type="button" class="btn btn-danger" onclick="window.location.href='./Contadores.html'">Anular</button>                                                     
                </td>
            </tr>
            <tr>
            <td>
                <br>
            </td>                
            </tr>
            <tr>
                <table id="example"  class="display">

                </table>
            </tr>
        </table>        
    </body>
</html>